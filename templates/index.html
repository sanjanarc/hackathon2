<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
    <title>Recipe Reboot Home </title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
  
    <!-- Favicons --> <!--HAVE TO CHANGE THESE -->
    <link href="../static/assets/img/favicon-32x32.png" rel="icon">
  
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="path/to/font-awesome/css/font-awesome.min.css">
    <script>"https://use.fontawesome.com/4190456980.js"</script>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  
    <!-- Vendor CSS Files -->
    <link href="../static/assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="../static/assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../static/assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="../static/assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="../static/assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="../static/assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  
    <!--  Main CSS File -->
    <link href="../static/assets/css/style.css" rel="stylesheet">
  </head>
  
  <body id="body">

<!-- ======= Header ======= -->
<header id="header" class="fixed-top">
  <div class="container-fluid d-flex justify-content-between align-items-center">

    <!--<h1 class="logo me-auto me-lg-0"><a href="index.html">Kelly</a></h1>*/-->
    <a href="index.html" class="logo"><img src="../static/assets/img/Free_Sample_By_Wix (1).jpeg" alt="" class="img-fluid"></a>
    

    <nav id="navbar" class="navbar order-last order-lg-0">
      <ul class="menu" >
        <li><a class="active" href="index.html">Home</a></li>
        
        <li><a href="create_recipe.html" >Create Recipe</a></li>
        </a></li>

      </ul>

    </nav><!-- .navbar -->

    <div id="search_bar">
      <input id="search_value" type = "text" placeholder="Find Recipes">
      <a href = "#">
        <i class = "fa fa-search"></i>
      </a>
    </div>


    <div class="header-favourites">
      <a  href="#"  onclick=""><i style="color:#064420; font-size: 20px;" class="bi bi-star"></i></a>
      

    </div>


    
  </div>

</header><!-- End Header -->



  <!-- ======= Feed Section ======= -->
  
<div id ="main">

  <!-- top three recipes -->
  <div class = "container-sm text-center" style = "margin-top: 0px">
    <h1 id = "title_div">
      POPULAR RECIPES
    </h1>

    <div id="recipe_super_div">
      
    </div>
  </div>

</div>

<div class = "container-fluid text-center" id = "filters">
  <div class = "row align-items-center" id="categories">
    <a class = "col filter" id = "filter1" href="">
      Filter by Cost
    </a>
    <a class = "col filter" id = "filter2" href="">
      Filter by Prep Time
    </a>
    <a class = "col filter" id = "filter3" href="">
      Filter by Ingredients
    </a>
    <a class = "col filter" id = "filter4" href="">
      Filter by xxxx
    </a>
    <a class = "col filter" id = "filter5" href="">
      Filter by xxxx
    </a>
  </div>
</div>

<div class = "container-md text-center">
  <h2>
    Other Recipes
  </h2>

  <div id = "other_recipes">

  </div>
</div>
    



  
  <!-- ======= Footer ======= -->
  <footer  id="footer">
    <div class="container">
      <div class="copyright">
        &copy; Copyright Recipe Reboot <strong><span></span></strong>. All Rights Reserved 
      </div>
      <div class="credits">
        Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
      </div>
    </div>
  </footer><!-- End  Footer -->
  <div id="preloader"></div>
  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>
  <script src="../static/assets/vendor/purecounter/purecounter.js"></script>
  <script src="../static/assets/vendor/aos/aos.js"></script>
  <script src="../static/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../static/assets/vendor/glightbox/js/glightbox.min.js"></script>
  <script src="../static/assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
  <script src="../static/assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="../static/assets/vendor/waypoints/noframework.waypoints.js"></script>
  <script src="../static/assets/vendor/php-email-form/validate.js"></script>

  <!--  Main JS File -->

  <script type="module">
    import database from "../static/assets/js/res/database_parsing/queries.js"

    // Generates a food 
    function generate_food_div(index) {
      return `<div class = 'col food_div' id = 'recipe_` + index + `'>
        <div id = 'recipe_image'>
          <a id = 'recipe_link_` + index + `'>
          <img class = 'img-fluid food_image' id ='recipe_image_` + index + `' src = '../static/assets/img/food2.jpg'>
          </img>
          <a>
          <div class = 'row align-items-center' id = 'likes'>
            <a class='like_button' id = 'like_button_` + index + `' data-gallery='portfolioGallery' class='col feed-lightbox'>
              <span id = 'heart'` + index + `>
                <i class='fa  fa-heart-o fa-3x' id='heart_` + index + `'' aria-hidden='true' >
                </i> 
              </span>
            </a>
            <div class='like-counter' id = 'num_likes_` + index + `'>
            </div>
          </div>
        </div> 
        <h class='recipe_name' id = 'recipe_title_` + index + `'>
        </h>
      </div>`
    }

    function load_recipe(recipes) {
      let food_div = $("#recipe_super_div");
      let total_text = "";

      //Adds the row organizer
      total_text += "<div class = 'row align-items-start food_row_maker' id = 'selectors'>"
      for (let i = 0; i < recipes.length; i++) {
        total_text += generate_food_div((i + 1));
      }
      total_text += "</div>"
      food_div.html(total_text);

      // Adds the recipes
      for (let i = 0; i < recipes.length; i++) {
        const index = i + 1;

        // Sets the recipes name
        const recipe_title = "recipe_title_" + index
        $('#' + recipe_title).html(recipes[i].name)

        // Sets the likes
        const recipe_likes = "num_likes_" + index
        $('#' + recipe_likes).html(recipes[i].likes)
        
        const recipe_image = "recipe_image_" + index
        $('#' + recipe_image).attr("src", recipes[i].image_link)

        // Enables clicking
        const like_span = "#heart" + index;
        const like_button = "#heart_" + index;
        $(like_button).click(
          function() {
            console.log("Clicked")
            let the_index = index; 
            if ($(like_button).hasClass("fa-heart")) {
              $(like_button).removeClass("fa-heart");
              $(like_button).addClass("fa-heart-o");

              database.unlike_recipe(recipes[i].name);
              let recipe_likes = "#num_likes_" + the_index
              $(recipe_likes).html(recipes[i].likes)
            } else {
              $(like_button).addClass("fa-heart");
              $(like_button).removeClass("fa-heart-o");

              database.like_recipe(recipes[i].name);
              let recipe_likes = "#num_likes_" + the_index
              $(recipe_likes).html(recipes[i].likes)
            }


          }
        )

        //Sets the href
        const recipe_link_ = '#recipe_link_' + index;
        let new_link = recipes[i].name;
        new_link = new_link.replaceAll(" ", ".")

        $(recipe_link_).attr("href", "recipes_page.html?" + new_link)
      }
    }

    export function load_all_recipes() {
      // Gets all the recipes
      load_recipe(database.get_all_recipes());
    }

    $('#search_value').change(
      function() {
        const content = $('#search_value').val()
        let all_recipes = database.get_all_recipes();
        let recipes = database.filter_name(all_recipes, content)
        load_recipe(recipes)
      }
    )
    window.onload = load_all_recipes();
  </script>
</body>

</html>